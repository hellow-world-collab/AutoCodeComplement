# AI 代码补全插件使用说明

## 功能简介

本插件为 PyCharm 2019.3.5 社区版提供了两个基于大语言模型的功能：

### 1. 智能代码补全（Shift + Alt + A）
- **开启/关闭**：按 `Shift + Alt + A` 切换 AI 代码补全功能
- **自动触发**：当功能开启时，在输入代码时会自动触发 AI 补全
- **显示建议**：补全建议以灰色文字显示在光标位置
- **接受建议**：按 `Tab` 键接受当前的补全建议

### 2. 代码分析与优化（Shift + Alt + E / R）
- **分析代码**：选中一段代码，按 `Shift + Alt + E` 发送给 AI 分析
- **查看差异**：AI 会返回优化建议，并在差异对比窗口中显示原始代码和修改建议
- **限制编辑**：差异窗口打开时，原代码编辑器将被锁定，无法编辑
- **应用修改**：按 `Shift + Alt + R` 应用 AI 的修改建议，或关闭差异窗口放弃修改

## 快捷键汇总

| 快捷键               | 功能 |
|-------------------|------|
| `Shift + Alt + A` | 开启/关闭 AI 代码补全 |
| `Tab`             | 接受代码补全建议 |
| `Shift + Alt + 1` | 将选中代码发送给 AI 分析 |
| `Shift + Alt + 2` | 应用 AI 的修改建议 |

## 配置说明

### 首次使用配置

1. 打开 PyCharm，进入 `File` -> `Settings` -> `AI Code Completion`
2. 配置以下选项：
   - **API URL**：大模型 API 地址（默认：OpenAI API）
   - **API Key**：你的 API 密钥（必填）
   - **Model**：使用的模型名称（默认：gpt-4o-mini）
   - **触发延迟**：输入后多久触发补全（默认：500ms）
   - **最大建议长度**：补全建议的最大字符数（默认：150）

3. 点击 `Apply` 保存设置

### 支持的 API

本插件支持所有兼容 OpenAI Chat Completions API 格式的服务，包括：
- OpenAI GPT 系列
- 其他兼容 OpenAI API 格式的服务（如 Azure OpenAI、本地部署的大模型等）

只需将 API URL 和 API Key 配置为对应服务的地址和密钥即可。

## 使用示例

### 示例 1：代码补全

```python
# 输入以下代码：
def calculate_sum(a, b):
    # 按下 Shift+Alt+A 开启补全
    # 输入 "return "，等待 AI 建议
    # 看到灰色提示 "a + b" 后按 Tab 接受
    return a + b
```

### 示例 2：代码优化

```python
# 选中以下代码：
result = []
for i in range(10):
    result.append(i * 2)

# 按 Shift+Alt+E 发送给 AI 分析
# AI 可能建议改为：
result = [i * 2 for i in range(10)]

# 在差异窗口中查看对比（此时原代码编辑器被锁定）
# 按 Shift+Alt+R 应用修改或关闭窗口放弃修改后，编辑器恢复可编辑状态
```

## 注意事项

1. **网络要求**：需要能够访问配置的 API 地址
2. **API 费用**：使用过程中会调用 API，可能产生费用
3. **延迟设置**：如果补全触发太频繁，可以增加触发延迟时间
4. **建议质量**：建议质量取决于所使用的模型和上下文内容

## 故障排查

### 补全不工作
1. 检查是否按 `Shift+Alt+A` 开启了补全功能
2. 检查 API Key 是否配置正确
3. 检查网络连接是否正常
4. 查看 IDE 日志中是否有错误信息

### 差异窗口不显示
1. 确保选中了代码再按 `Shift+Alt+1`
2. 检查 API 是否返回了有效结果
3. 等待 AI 分析完成（可能需要几秒钟）



## 开发信息

- **插件 ID**：com.system.demo
- **适用版本**：PyCharm Community Edition 2019.3.5
- **开发语言**：Java
- **依赖库**：OkHttp、org.json

## 许可证

本插件仅供学习和个人使用。
